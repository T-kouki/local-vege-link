{% extends 'eat_base.html' %}

{% load static %}

{% block content %}
<div class="item-detail">

  <!-- 左側：商品画像 -->
  <div class="item-images">
    {% if item.image %}
      <img src="{{ item.image.url }}" alt="{{ item.name }}">
    {% else %}
      <img src="{% static 'images/noimage.png' %}" alt="画像なし">
    {% endif %}
  </div>

  <!-- 右側：商品情報 -->
  <div class="item-info">
    <h1>{{ item.name }}</h1>
    <h2>¥{{ item.price }}</h2>

    <!-- 農家情報 -->
    <div class="farmer-info">
      <div class="farmer-profile">
        {% if item.user.profile_image %}
          <img src="{{ item.user.profile_image.url }}" alt="農家プロフィール画像">
        {% else %}
          <img src="{% static 'images/default_user.png' %}" alt="プロフィールなし">
        {% endif %}
      </div>

      <div class="farmer-name">
        <p>
          {% if item.user.id %}
            <!-- 農家詳細ページへのリンク -->
            <a href="{% url 'farm_detail' pk=item.user.id %}">
              {{ item.user.nickname }}
            </a>
          {% else %}
            <span>{{ item.user.nickname }}</span>
          {% endif %}
        </p>
      </div>

      <div class="farmer-rating">
        <!-- 平均評価（仮定） -->
        {% if avg_rating %}
          <p>評価: {{ avg_rating }} / 5</p>
        {% else %}
          <p>評価なし</p>
        {% endif %}
      </div>
    </div>

    <!-- 商品説明 -->
    <div class="item-description">
      <p>{{ item.description|linebreaksbr }}</p>
    </div>

    <!-- カートに入れる -->
    <div class="add-to-cart">
      <form method="post" action="{% url 'polls:add_to_cart' item.id %}">
        {% csrf_token %}
        <button type="submit" class="cart-button">カートに入れる</button>
      </form>
    </div>

  </div>
</div>
{% endblock %}
